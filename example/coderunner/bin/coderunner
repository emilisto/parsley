#!/usr/bin/env node

var fs = require('fs');
var CodeRunner = require('../coderunner');
var optimist = require('optimist')
  .usage('Usage: $0 <path-to-script>');

var fail = function(e) {
  optimist.showHelp();
  console.error('ERROR:', e.message);
  console.error(e.stack);
  process.exit(1);
};

try {
  var path = optimist.argv._.pop();
  var code = fs.readFileSync(path).toString();

  new CodeRunner({ redisPort: 16379 })
    .run(code, [ "and, coooooool" ])
    .get(function(err, result) {
      console.log('got it!');
      console.log(arguments);
    });

} catch(e) {
  fail(e);
}


